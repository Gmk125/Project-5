import openpyxl


def main():
    pop = open_worksheet()
    show_pop_change=should_display_pop_change()



def open_worksheet():
    Wb = openpyxl.load.workbook("countyPopChange2020-2021")
    worksheet = Wb.active
    for i in range(0,worksheet.max_row):
        for col in worksheet.iter.cols(1,worksheet.max_column):
            data=col[i].value
    return data


def should_display_pop_change():
    user_input= input("Do you want to display a map of total population change")
    if user_input=="yes":
        return True
    elif user_input=="no":
         return False

def show_pop_change_map():
    location_array= []
    population_array= []
    wb=openpyxl.load_workbook('countyPopChange2020-2021.xslx')
    worksheet=wb.active
    for row in  worksheet.iter.rows_rows(1,worksheet.max_row):
        if row[4].value==0:
            print(row[5].value)
            print(row[11].value)
            print()
            location_array.append(row[5].value)
            population_array.append(row[11].value)

    map_fig=plotly.graph_objects.Figure(
        data=plotly.graph_objects.Choropleth(
             locations=location_array,
             z=population_array,
             locationmode='USA-states',
             colorscale='Reds',
        ))

    map_fig.show()



main()
         
         
